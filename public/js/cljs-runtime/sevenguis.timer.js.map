{"version":3,"sources":["sevenguis/timer.cljs"],"mappings":";AAKA,AAAA,AAAKA;AAEL,AAAA,AAAKC;AAEL,AAAA,AAAKC;AAEL,AAAA,AAAKC;AAEL,AAAA,AAAKC;AAEL,AAAA,AAAAC,AAAAC,AAAAC;AAAA;AAAA,AAAA,AAASC,AAAQ,AAAA,AAAA,AAAA,AAAA,AAACC,AACkBN;;AAEpC,AAAKO,AAAS,AAAA,AAAA,AAACC,AAASH;AAExB,AAAKI,AAAU,AAAA,AAAA,AAACD,AAASH;AAEzB,AAAA,AAAKK;AAEL,AAAA,AAAKC;AAEL,AAAA,AAAMC;AAAN,AAAc,AAACC,AAASN,AAAS,AAACO,AAAQC,AAAElB;;AAE5C,AAAKmB,AAAS,AAAA,AAACC;AAEf,AAAA,AAAMC;AAAN,AACE,AAAA,AAAAC,AAAWH;AAAX;;AAAA,AACE,AAACI,AAAOJ,AACA,AAACK,AACC;AAAA,AACE,AAAU,AAAAC,AAAI,AAAA,AAAAH,AAAA,AAAAA,AAAIZ,AAAUE;AAAlB,AAAA,AAAAa;AAAAA;;AACI,AAAA,AAAAH,AAAA,AAAAA,AAAC,AAACL,AACCS,AACAxB,AAAwCQ,AAAUE;;;AAHnE;;AAAA,AAIE,AAACG;;AACL,AAAA,AAAQf;;;AAEtB,AAAA,AAAM2B;AAAN,AACE,AAAA,AAAAL,AAACM,AAAkBT;;AACnB,AAAA,AAACI,AAAOJ;;AAEV,AAAKU,AAAY;AAAA,AACE,AAACF;;AACD,AAAA,AAACJ,AAAOb;;AAE3B,AAAA,AAAMoB;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAEuBT,AACAM,AACAE;;AAEvB,AAAA,AAAME;AAAN,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAKa,AAAA,AAAAT,AAAA,AAAAA,AAAIZ,AAAUE,AAEhB,AAAA,AAAK,AAAA,AAAAU,AAAWZ,AAAST,AAG/B+B,AAAuCpB,AACDT,AACAC,AACAS,AACAC,AAEvCgB","names":["sevenguis.timer/seconds-between-ticks","sevenguis.timer/n-decimal-places","sevenguis.timer/precision-for-detecting-if-time-is-up","sevenguis.timer/min-duration","sevenguis.timer/max-duration","js/sevenguis","js/sevenguis.timer","js/sevenguis.timer.!app-db","sevenguis.timer/!app-db","reagent.core.atom","sevenguis.timer/!elapsed","reagent.core/cursor","sevenguis.timer/!duration","sevenguis.timer/bubble-scale","sevenguis.timer/bubble-shift","sevenguis.timer/tick","reagent.core/rswap!","cljs.core.partial","cljs.core/+","sevenguis.timer/!ticking","cljs.core.atom","sevenguis.timer/start-clock","cljs.core/deref","cljs.core/reset!","js/setInterval","or__4126__auto__","sevenguis.util/within","sevenguis.timer/stop-clock","js/clearInterval","sevenguis.timer/reset-clock","sevenguis.timer/button-row","sevenguis.timer/timer","sevenguis.util/range-with-bubble"],"sourcesContent":["(ns sevenguis.timer\n  (:require\n    [reagent.core :as r]\n    [sevenguis.util :as util]))\n\n(def seconds-between-ticks 0.05)\n\n(def n-decimal-places 2)\n\n(def precision-for-detecting-if-time-is-up 0.01)\n\n(def min-duration 5)\n\n(def max-duration 300)\n\n(defonce !app-db (r/atom {:elapsed  0\n                          :duration min-duration}))\n\n(def !elapsed (r/cursor !app-db [:elapsed]))\n\n(def !duration (r/cursor !app-db [:duration]))\n\n(def bubble-scale 112)\n\n(def bubble-shift 10)\n\n(defn tick [] (r/rswap! !elapsed (partial + seconds-between-ticks)))\n\n(def !ticking (atom nil))\n\n(defn start-clock []\n  (when-not @!ticking\n    (reset! !ticking\n            (js/setInterval\n              (fn tick-if-time-left []\n                (when-not (or (> @!elapsed @!duration)\n                              ((partial\n                                 util/within\n                                 precision-for-detecting-if-time-is-up) @!elapsed @!duration))\n                  (tick)))\n              (* 1000 seconds-between-ticks)))))\n\n(defn stop-clock []\n  (js/clearInterval @!ticking)\n  (reset! !ticking nil))\n\n(def reset-clock (fn []\n                   (stop-clock)\n                   (reset! !elapsed 0)))\n\n(defn button-row []\n  [:div.gui-line.button-line\n   [:button {:on-click start-clock} \"Start\"]\n   [:button {:on-click stop-clock} \"Stop\"]\n   [:button {:on-click reset-clock} \"Reset\"]])\n\n(defn timer []\n  [:div.timer.gui\n   [:div.gui-line\n    [:span \"Elapsed time:\"]\n    [:progress.timer-progress\n     {:value (/ @!elapsed @!duration)}]]\n   [:div.gui-line\n    [:span (str (.toFixed @!elapsed n-decimal-places) \"s\")]]\n   [:div.gui-line\n    [:span \"Duration:\"]\n    [util/range-with-bubble {:!value        !duration\n                             :min          min-duration\n                             :max          max-duration\n                             :bubble-scale bubble-scale\n                             :bubble-shift bubble-shift\n                             :label        \"s\"}]]\n   [button-row]])\n"]}